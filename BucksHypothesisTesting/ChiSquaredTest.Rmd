---
title: "Chi-Squared Tests for Account Dataset 2023 & 2024"
date: 'Date: May 3, 2025'
output: html_notebook
---

# Reading in the Dataset
We start off by reading the `.csv` file into a dataframe. This will allow us to perform the necessary operations 
needed to extract the data that we're concerned about, as well as perform the statistical tests, which can give us 
more insights into the data. 

**Note:** it is worth noting that we apply the bonferroni correction to all of our testing as well as set the 
signifigance level to 0.05.

```{r setup, message=FALSE, warning=FALSE}

library(dplyr)
library(ggplot2)
library(rlang)
library(gridExtra)

# reading in the data into data frames
ALGLSL_2023 <- read.csv("C:/GitHub/BucksHackathon25/BucksDatasets/ALGLSL_2023.csv")
ALGLSL_2024 <- read.csv("C:/GitHub/BucksHackathon25/BucksDatasets/ALGLSL_2024.csv")
CustomerPlans <- read.csv("C:/GitHub/BucksHackathon25/BucksDatasets/CustomerPlans_2023.csv")


```

## Function for Perfoming Chi-Sqaured Test
Before we perform any chi-sqaured tests, we would like to create a function that is designed to perform a 
chi-squared test on the features that we're interested in, as this would save us from writing multiple lines of 
code.

```{r}

# function for performing a chi-squared test
run_chi_squared_test <- function(dataset, feature_one, feature_two) {

    # creating a contingency table
    contingency_table <- table(dataset[[feature_one]], dataset[[feature_two]])

    # running the chi-squared test
    chi_results <- chisq.test(contingency_table)

    # determing statistical signifigance
    if(chi_results$p.value < 0.05) {
        print("Statistical Signifigance is Present")

        posthoc_result <- rcompanion::pairwiseNominalIndependence(
        contingency_table,
        chisq = TRUE,
        fisher = FALSE,
        method = "bonferroni"
      )
      print(posthoc_result)

    } else {
        print("No Statistical Signifigance Detected")
    }

}


```

## Chi-Squared Test on STM vs FanSegment
After establishing the function, we now decide to conduct a chi-squared test on STM against the FanSegment feature. We also perform a post-hoc pairwise test.
The Null and Alternative Hypothesis is stated as follows:
- **Null Hypothesis:** there is no association between STM and FanSegment
- **Alternative Hypothesis:** there is an association between STM and FanSegment

```{r}

# running the chi-squared test function for the 2023 dataset
run_chi_squared_test(ALGLSL_2023, 'FanSegment', 'STM')

# running the chi-squared test function for the 2024 dataset
run_chi_squared_test(ALGLSL_2024, 'FanSegment', 'STM')


```


## Chi-Squared Test on FanSegment vs GameTier
After establishing the function, we now decide to conduct a chi-squared test on FanSegment against the GameTier feature. We also perform a post-hoc pairwise 
test. The Null and Alternative Hypothesis is stated as follows:
- **Null Hypothesis:** there is no association between GameTier and FanSegment
- **Alternative Hypothesis:** there is an association between GameTier and FanSegment

```{r}
# running the chi-squared test function for the 2023 dataset
run_chi_squared_test(ALGLSL_2023, 'GameTier', 'FanSegment')

# running the chi-squared test function for the 2024 dataset
run_chi_squared_test(ALGLSL_2024, 'GameTier', 'FanSegment')

```



## Chi-Squared Test on SocialMediaEngagement vs GameTier
After establishing the function, we now decide to conduct a chi-squared test on SocialMediaEngagement against the GameTier feature. We also perform a 
post-hoc pairwise test. The Null and Alternative Hypothesis is stated as follows:
- **Null Hypothesis:** there is no association between SocialMediaEngagement and GameTier
- **Alternative Hypothesis:** there is an association between SocialMediaEngagement and GameTier

```{r}
# running the chi-squared test function for the 2023 dataset
run_chi_squared_test(ALGLSL_2023, 'GameTier', 'SocialMediaEngagement')

# running the chi-squared test function for the 2024 dataset
run_chi_squared_test(ALGLSL_2024, 'GameTier', 'SocialMediaEngagement')


```


## Chi-Squared Test on STM vs GameTier 
After establishing the function, we now decide to conduct a chi-squared test on STM against the GameTier feature. We also perform a post-hoc pairwise test. 
The Null and Alternative Hypothesis is stated as follows:
- **Null Hypothesis:** there is no association between STM and GameTier
- **Alternative Hypothesis:** there is an association between STM and GameTier

```{r}

# running the chi-squared test function for the 2023 dataset
run_chi_squared_test(ALGLSL_2023, 'GameTier', 'STM')

# running the chi-squared test function for the 2024 dataset
run_chi_squared_test(ALGLSL_2024, 'GameTier', 'STM')


```

## Chi-Squared Test on GiveawayLabel vs SocialMediaEngagement
After establishing the function, we now decide to conduct a chi-squared test on GiveawayLabel against the 
SocialMediaEngagement feature. We also perform a post-hoc pairwise test. 
The Null and Alternative Hypothesis is stated as follows:
- **Null Hypothesis:** there is no association between GiveawayLabel and SocialMediaEngagement
- **Alternative Hypothesis:** there is an association between GiveawayLabel and SocialMediaEngagement
```{r}

# running the chi-squared test function for the 2023 dataset
run_chi_squared_test(ALGLSL_2023, 'GiveawayLabel', 'SocialMediaEngagement')

# running the chi-squared test function for the 2024 dataset
run_chi_squared_test(ALGLSL_2024, 'GiveawayLabel', 'SocialMediaEngagement')


```


## Chi-Squared Test on GiveawayLabel vs GameTier
After establishing the function, we now decide to conduct a chi-squared test on GiveawayLabel against the 
GameTier feature. We also perform a post-hoc pairwise test. 
The Null and Alternative Hypothesis is stated as follows:
- **Null Hypothesis:** there is no association between GiveawayLabel and GameTier
- **Alternative Hypothesis:** there is an association between GiveawayLabel and GameTier
```{r}

# running the chi-squared test function for the 2023 dataset
run_chi_squared_test(ALGLSL_2023, 'GiveawayLabel', 'GameTier')

# running the chi-squared test function for the 2024 dataset
run_chi_squared_test(ALGLSL_2024, 'GiveawayLabel', 'GameTier')


```

## Chi-Squared Test on GiveawayLabel vs FanSegment
After establishing the function, we now decide to conduct a chi-squared test on GiveawayLabel against the 
FanSegment feature. We also perform a post-hoc pairwise test. 
The Null and Alternative Hypothesis is stated as follows:
- **Null Hypothesis:** there is no association between GiveawayLabel and FanSegment
- **Alternative Hypothesis:** there is an association between GiveawayLabel and FanSegment
```{r}

# running the chi-squared test function for the 2023 dataset
run_chi_squared_test(ALGLSL_2023, 'GiveawayLabel', 'FanSegment')

# running the chi-squared test function for the 2024 dataset
run_chi_squared_test(ALGLSL_2024, 'GiveawayLabel', 'FanSegment')


```

## Chi-Squared Test on Cluster vs STM, FanSegment, SocialMediaEngagement & GameTier
```{r}

features = c('STM', 'FanSegment', 'SocialMediaEngagement', 'GameTier', 'GiveawayLabel')
for (feature in features) {
    run_chi_squared_test(CustomerPlans, 'Cluster', feature)
}
```
